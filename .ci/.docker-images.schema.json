{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://raw.githubusercontent.com/elastic/apm-pipeline-library/main/.ci/.docker-images.schema.json",
  "title": "Docker Images Config",
  "description": "Config to build docker images",
  "type": "object",
  "properties": {
    "templates": {
      "type": "array"
    },
    "images": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the image <name>:<tag>."
          },
          "repo": {
            "type": "string",
            "description": "The repo where the Dockerfile is."
          },
          "tag": {
            "type": "string",
            "description": "The tag of the image <name>:<tag>."
          },
          "prepare_script": {
            "type": "string",
            "description": "A script to run before the build script."
          },
          "build_script": {
            "type": "string",
            "description": "Override the default build script."
          },
          "push_script": {
            "type": "string",
            "description": "Override the default push script."
          },
          "test_script": {
            "type": "string",
            "description": "A test script that runs after building and before pushing."
          },
          "push": {
            "type": "boolean",
            "description": "Push the image (default: true).",
            "default":  true
          },
          "folder": {
            "type": "string",
            "description": "The folder for the working directory."
          },
          "build_opts": {
            "type": "string",
            "description": "Additional build options. Only if the default build script is not overridden."
          }
        },
        "required": [
          "name"
        ],
        "additionalProperties": false
      }
    }
  }
}
